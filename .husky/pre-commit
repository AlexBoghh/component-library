#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Run quality checks before commit
echo "ğŸš€ Running pre-commit quality checks..."

# Run TypeScript type checking
echo "ğŸ“ Checking TypeScript types..."
npx tsc --noEmit || {
  echo "âŒ TypeScript errors found. Please fix before committing."
  exit 1
}

# Run ESLint
echo "ğŸ” Running ESLint..."
npm run lint || {
  echo "âŒ ESLint errors found. Please fix before committing."
  exit 1
}

# Run tests if they exist
if [ -f "package.json" ] && grep -q "\"test\"" package.json; then
  echo "ğŸ§ª Running tests..."
  npm test --passWithNoTests || {
    echo "âŒ Tests failed. Please fix before committing."
    exit 1
  }
fi

echo "âœ… All pre-commit checks passed!"